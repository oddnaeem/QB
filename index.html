<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <title>প্রশ্নব্যাংক</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />
  <style>
    .fab-container {
      position: fixed;
      bottom: 20px;
      right: 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      z-index: 1050;
    }

    .fab-button {
      width: 56px;
      height: 56px;
      border-radius: 50%;
      font-size: 24px;
      padding: 0;
      line-height: 56px;
      text-align: center;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    }
  </style>
</head>
<body class="bg-light">

  <div class="container py-4">
    <h2 class="text-center mb-4">প্রশ্নব্যাংক</h2>
    <div id="questionList" class="row gy-3"></div>
  </div>

  <div class="fab-container">
    <button
      class="btn btn-primary fab-button"
      title="প্রশ্ন তৈরি"
      data-bs-toggle="modal"
      data-bs-target="#questionModal"
    >
      <i class="bi bi-plus"></i>
    </button>
    <button class="btn btn-success fab-button" title="ডাউনলোড" onclick="downloadJSON()">
      <i class="bi bi-download"></i>
    </button>
  </div>

  <div
    class="modal fade"
    id="questionModal"
    tabindex="-1"
    aria-labelledby="questionModalLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="questionModalLabel">নতুন প্রশ্ন যোগ করুন</h5>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
            aria-label="Close"
            onclick="clearForm()"
          ></button>
        </div>
        <div class="modal-body">
          <input
            type="text"
            class="form-control mb-2"
            id="questionText"
            placeholder="প্রশ্ন লিখুন"
          />
          <input
            type="text"
            class="form-control mb-2"
            id="option1"
            placeholder="অপশন ১"
          />
          <input
            type="text"
            class="form-control mb-2"
            id="option2"
            placeholder="অপশন ২"
          />
          <input
            type="text"
            class="form-control mb-2"
            id="option3"
            placeholder="অপশন ৩"
          />
          <input
            type="text"
            class="form-control mb-2"
            id="option4"
            placeholder="অপশন ৪"
          />

          <select class="form-select" id="correctAnswer">
            <option value="" selected disabled>সঠিক উত্তর নির্বাচন করুন</option>
            <option value="1">অপশন ১</option>
            <option value="2">অপশন ২</option>
            <option value="3">অপশন ৩</option>
            <option value="4">অপশন ৪</option>
          </select>
        </div>
        <div class="modal-footer">
          <button
            type="button"
            class="btn btn-secondary"
            data-bs-dismiss="modal"
            onclick="clearForm()"
          >
            বাতিল
          </button>
          <button type="button" class="btn btn-primary" onclick="addQuestion()">
            সংরক্ষণ
          </button>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    const questions = [];

    function addQuestion() {
      const question = document.getElementById("questionText").value.trim();
      const options = [
        document.getElementById("option1").value.trim(),
        document.getElementById("option2").value.trim(),
        document.getElementById("option3").value.trim(),
        document.getElementById("option4").value.trim(),
      ];
      const correct = parseInt(document.getElementById("correctAnswer").value);

      if (!question || options.includes("") || isNaN(correct)) {
        alert("অনুগ্রহ করে সব তথ্য দিন।");
        return;
      }

      const q = {
        question: question,
        options: options,
        correctAnswerIndex: correct - 1,
      };

      questions.push(q);
      displayQuestions();

      const modal = bootstrap.Modal.getInstance(
        document.getElementById("questionModal")
      );
      modal.hide();
      clearForm();
    }

    function displayQuestions() {
      const list = document.getElementById("questionList");
      list.innerHTML = "";
      questions.forEach((q, i) => {
        const card = `
          <div class="col-12">
            <div class="card shadow-sm">
              <div class="card-body">
                <h5 class="card-title">প্রশ্ন ${i + 1}</h5>
                <p class="card-text">${q.question}</p>
                <ul class="list-group list-group-flush">
                  ${q.options
                    .map(
                      (opt, j) =>
                        `<li class="list-group-item ${
                          j === q.correctAnswerIndex
                            ? "list-group-item-success"
                            : ""
                        }">
                          ${j + 1}. ${opt} ${
                          j === q.correctAnswerIndex ? "(সঠিক)" : ""
                        }
                        </li>`
                    )
                    .join("")}
                </ul>
              </div>
            </div>
          </div>
        `;
        list.innerHTML += card;
      });
    }

    function clearForm() {
      document.getElementById("questionText").value = "";
      document.getElementById("option1").value = "";
      document.getElementById("option2").value = "";
      document.getElementById("option3").value = "";
      document.getElementById("option4").value = "";
      document.getElementById("correctAnswer").value = "";
    }

    function downloadJSON() {
      if (questions.length === 0) {
        alert("প্রথমে কিছু প্রশ্ন যোগ করুন।");
        return;
      }

      const dataStr =
        "data:text/json;charset=utf-8," +
        encodeURIComponent(JSON.stringify(questions, null, 2));
      const a = document.createElement("a");
      a.setAttribute("href", dataStr);
      a.setAttribute("download", "questions.json");
      document.body.appendChild(a);
      a.click();
      a.remove();
    }
  </script>
</body>
</html>
