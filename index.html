<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>‡¶¨‡¶æ‡¶ó‡¶ß‡¶æ‡¶∞‡¶æ MCQ ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ</title>
<style>
  body {
    font-family: "Noto Sans Bengali", sans-serif;
    background: #f0f4f8;
    margin: 0; padding: 0;
  }
  .container {
    max-width: 800px;
    margin: 20px auto;
    background: #fff;
    padding: 25px;
    border-radius: 10px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  }
  h2, h3 {
    text-align: center;
    color: #2c3e50;
  }
  input[type="number"], button {
    font-size: 16px;
    padding: 10px;
    margin: 10px;
    border-radius: 8px;
  }
  .question {
    margin-bottom: 30px;
    border-bottom: 1px solid #ddd;
    padding-bottom: 10px;
  }
  .options label {
    display: block;
    background: #f9f9f9;
    margin: 6px 0;
    padding: 10px;
    border-radius: 6px;
    cursor: pointer;
    border: 1px solid #ccc;
  }
  .options input {
    margin-right: 10px;
  }
  .feedback {
    margin-top: 5px;
    font-weight: bold;
  }
  .correct { color: green; }
  .incorrect { color: red; }
  .answer-box {
    margin-top: 10px;
    padding: 10px;
    border-left: 5px solid green;
    background: #eafaf1;
    border-radius: 6px;
  }
  #timer {
    text-align: center;
    font-size: 20px;
    font-weight: bold;
    color: #d35400;
    margin-bottom: 15px;
  }
  .toast {
    visibility: hidden;
    min-width: 250px;
    background-color: #2ecc71;
    color: white;
    text-align: center;
    border-radius: 8px;
    padding: 16px;
    position: fixed;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 1000;
    font-size: 16px;
    opacity: 0;
    transition: visibility 0s, opacity 0.5s ease-in-out;
  }
  .toast.show {
    visibility: visible;
    opacity: 1;
  }
</style>
</head>
<body>

<div class="container" id="startScreen">
  <h2>üìù ‡¶¨‡¶æ‡¶ó‡¶ß‡¶æ‡¶∞‡¶æ ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ‡ßü ‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ</h2>
  <label>‡¶∏‡¶Æ‡ßü ‡¶≤‡¶ø‡¶ñ‡ßã (‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°):</label>
  <input type="number" id="timeLimit" value="180" min="30" max="999" step="1" />
  <br />
  <button onclick="startExam()">‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶∂‡ßÅ‡¶∞‡ßÅ</button>
</div>

<div class="container" id="quizContainer" style="display:none;">
  <h3>üìò ‡¶ü‡¶™‡¶ø‡¶ï: ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶¨‡¶æ‡¶ó‡¶ß‡¶æ‡¶∞‡¶æ</h3>
  <div id="timer">‚è≥ ‡¶ü‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞: </div>
  <form id="quizForm"></form>
</div>

<div id="toast" class="toast"></div>

<script>
  const allQuestions = [
    {
      question: "‡¶Ö‡¶ï‡¶æ‡¶≤ ‡¶¨‡ßã‡¶ß‡¶® ‡¶Ö‡¶∞‡ßç‡¶• ‡¶ï‡ßÄ?",
      options: ["‡¶∂‡ßá‡¶∑ ‡¶¨‡¶ø‡¶¶‡¶æ‡¶Ø‡¶º", "‡¶Ö‡¶∏‡¶Æ‡¶Ø‡¶º‡ßá ‡¶Ü‡¶¨‡¶ø‡¶∞‡ßç‡¶≠‡¶æ‡¶¨", "‡¶∂‡ßá‡¶∑ ‡¶∏‡¶Æ‡¶Ø‡¶º‡ßá‡¶∞ ‡¶ï‡¶æ‡¶ú", "‡¶∏‡¶Æ‡¶Ø‡¶º‡ßá ‡¶Ü‡¶¨‡¶ø‡¶∞‡ßç‡¶≠‡¶æ‡¶¨"],
      answer: "‡¶Ö‡¶∏‡¶Æ‡¶Ø‡¶º‡ßá ‡¶Ü‡¶¨‡¶ø‡¶∞‡ßç‡¶≠‡¶æ‡¶¨"
    },
    {
      question: "‡¶Ö‡¶ï‡¶æ‡¶≤‡ßá ‡¶¨‡¶æ‡¶ß‡¶æ ‡¶Ö‡¶∞‡ßç‡¶• ‡¶ï‡ßÄ?",
      options: ["‡¶Ö‡¶™‡ßç‡¶∞‡¶§‡ßç‡¶Ø‡¶æ‡¶∂‡¶ø‡¶§ ‡¶¨‡¶æ‡¶ß‡¶æ"],
      answer: "‡¶Ö‡¶™‡ßç‡¶∞‡¶§‡ßç‡¶Ø‡¶æ‡¶∂‡¶ø‡¶§ ‡¶¨‡¶æ‡¶ß‡¶æ"
    },
    {
      question: "‡¶Ö‡¶ï‡¶æ‡¶≤ ‡¶ï‡ßÅ‡¶∏‡ßÅ‡¶Æ ‡¶Ö‡¶∞‡ßç‡¶• ‡¶ï‡ßÄ?",
      options: ["‡¶π‡¶§‡¶¨‡ßÅ‡¶¶‡ßç‡¶ß‡¶ø", "‡¶∏‡ßÅ‡¶¶‡ßÇ‡¶∞‡¶¶‡¶∞‡ßç‡¶∂‡ßÄ", "‡¶∏‡ßÅ‡¶®‡ßç‡¶¶‡¶∞ ‡¶´‡ßÅ‡¶≤", "‡¶¨‡ßÅ‡¶°‡¶º‡¶ø", "‡¶Ö‡¶ï‡ßá‡¶ú‡ßã ‡¶¨‡¶æ ‡¶Ö‡¶™‡¶¶‡¶æ‡¶∞‡ßç‡¶•"],
      answer: "‡¶Ö‡¶ï‡ßá‡¶ú‡ßã ‡¶¨‡¶æ ‡¶Ö‡¶™‡¶¶‡¶æ‡¶∞‡ßç‡¶•"
    },
    {
      question: "‡¶Ö‡¶ï‡¶æ‡¶≤ ‡¶ï‡ßÅ‡¶∏‡ßÅ‡¶Æ ‡¶Ö‡¶∞‡ßç‡¶• ‡¶ï‡ßÄ?",
      options: ["‡¶Ö‡¶ï‡¶æ‡¶≤‡ßá‡¶∞ ‡¶´‡ßÅ‡¶≤", "‡¶´‡ßÅ‡¶≤ ‡¶®‡¶Ø‡¶º ‡¶è‡¶Æ‡¶®", "‡¶Ö‡¶∏‡¶Æ‡¶Ø‡¶º‡ßá‡¶∞ ‡¶ú‡¶ø‡¶®‡¶ø‡¶∏", "‡¶°‡¶ø‡¶ú‡ßá‡¶∞ ‡¶ï‡ßÅ‡¶∏‡ßÅ‡¶Æ"],
      answer: "‡¶Ö‡¶ï‡¶æ‡¶≤‡ßá‡¶∞ ‡¶´‡ßÅ‡¶≤"
    },
    {
      question: "‡¶Ö‡¶ï‡¶æ‡¶≤‡¶™‡¶ï‡ßç‡¶¨ ‡¶Ö‡¶∞‡ßç‡¶• ‡¶ï‡ßÄ?",
      options: ["‡¶á‡¶Å‡¶ö‡¶°‡¶º‡ßá ‡¶™‡¶æ‡¶ï", "‡¶Ü‡¶ö‡¶æ‡¶∞ ‡¶™‡¶æ‡¶ï", "‡¶Ö‡¶ï‡¶æ‡¶≤‡ßá ‡¶™‡¶æ‡¶ï‡¶æ", "‡¶ï‡ßã‡¶®‡ßã‡¶ü‡¶ø‡¶á ‡¶®‡¶Ø‡¶º"],
      answer: "‡¶Ö‡¶ï‡¶æ‡¶≤‡ßá ‡¶™‡¶æ‡¶ï‡¶æ"
    }
  ];

  let selectedQuestions = [];
  let timeLeft = 60;
  let timerInterval;
  let score = 0;
  let attempted = 0;
  const TOTAL_QUESTIONS = 30;

  function shuffleArray(array) {
    return array.sort(() => Math.random() - 0.5);
  }

  function startExam() {
    const userTime = parseInt(document.getElementById("timeLimit").value);
    timeLeft = isNaN(userTime) || userTime < 10 ? 60 : userTime;

    selectedQuestions = shuffleArray([...allQuestions]).slice(0, TOTAL_QUESTIONS);

    document.getElementById("startScreen").style.display = "none";
    document.getElementById("quizContainer").style.display = "block";

    renderQuestions();
    startTimer();
  }

  function renderQuestions() {
    const form = document.getElementById("quizForm");
    form.innerHTML = "";
    score = 0;
    attempted = 0;

    selectedQuestions.forEach((q, index) => {
      const div = document.createElement("div");
      div.className = "question";
      div.innerHTML = `<strong>${index + 1}. ${q.question}</strong>`;

      const optionsDiv = document.createElement("div");
      optionsDiv.className = "options";

      shuffleArray(q.options).forEach(opt => {
        const id = `q${index}_${opt}`;
        const label = document.createElement("label");
        label.innerHTML = `
          <input type="radio" name="q${index}" value="${opt}" id="${id}"> ${opt}
        `;
        const input = label.querySelector("input");

        input.addEventListener("change", function () {
          if (input.disabled) return;

          const all = document.querySelectorAll(`input[name="q${index}"]`);
          all.forEach(el => el.disabled = true);
          attempted++;

          const isCorrect = input.value === q.answer;
          if (isCorrect) score++;

          showFeedback(index, isCorrect, q.answer);

          if (attempted === selectedQuestions.length) {
            endExam();
          }
        });

        optionsDiv.appendChild(label);
      });

      const feedback = document.createElement("div");
      feedback.className = "feedback";
      feedback.id = `feedback${index}`;

      const answerBox = document.createElement("div");
      answerBox.className = "answer-box";
      answerBox.id = `answerBox${index}`;
      answerBox.style.display = "none";

      div.appendChild(optionsDiv);
      div.appendChild(feedback);
      div.appendChild(answerBox);
      form.appendChild(div);
    });
  }

  function showFeedback(index, isCorrect, correctAnswer) {
    const feedback = document.getElementById(`feedback${index}`);
    const answerBox = document.getElementById(`answerBox${index}`);
    feedback.textContent = isCorrect ? "‚úÖ ‡¶∏‡¶†‡¶ø‡¶ï ‡¶â‡¶§‡ßç‡¶§‡¶∞!" : "‚ùå ‡¶≠‡ßÅ‡¶≤ ‡¶â‡¶§‡ßç‡¶§‡¶∞!";
    feedback.className = `feedback ${isCorrect ? "correct" : "incorrect"}`;

    if (!isCorrect) {
      answerBox.innerHTML = `‚úÖ ‡¶∏‡¶†‡¶ø‡¶ï ‡¶â‡¶§‡ßç‡¶§‡¶∞: <strong>${correctAnswer}</strong>`;
      answerBox.style.display = "block";
    }
  }

  function startTimer() {
    const timerDisplay = document.getElementById("timer");
    timerDisplay.textContent = `‚è≥ ‡¶ü‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞: ${timeLeft} ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°`;

    timerInterval = setInterval(() => {
      timeLeft--;
      timerDisplay.textContent = `‚è≥ ‡¶ü‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞: ${timeLeft} ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°`;
      if (timeLeft <= 0) {
        clearInterval(timerInterval);
        lockAllAndShowAnswers();
        endExam();
      }
    }, 1000);
  }

  function lockAllAndShowAnswers() {
    selectedQuestions.forEach((q, index) => {
      // Disable all options of question index
      const all = document.querySelectorAll(`input[name="q${index}"]`);
      all.forEach(el => el.disabled = true);

      // If user didn't answer, show feedback as incorrect + correct answer
      const checked = document.querySelector(`input[name="q${index}"]:checked`);
      if (!checked) {
        const feedback = document.getElementById(`feedback${index}`);
        const answerBox = document.getElementById(`answerBox${index}`);

        feedback.textContent = "‚è∞ ‡¶∏‡¶Æ‡ßü ‡¶∂‡ßá‡¶∑! ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶¶‡ßá‡ßü‡¶æ ‡¶π‡ßü‡¶®‡¶ø";
        feedback.className = "feedback incorrect";

        answerBox.innerHTML = `‚úÖ ‡¶∏‡¶†‡¶ø‡¶ï ‡¶â‡¶§‡ßç‡¶§‡¶∞: <strong>${q.answer}</strong>`;
        answerBox.style.display = "block";
      }
    });
  }

  function endExam() {
    clearInterval(timerInterval);
    showToast(`üéâ ‡¶Ü‡¶™‡¶®‡¶ø ${selectedQuestions.length}-‡¶ü‡¶ø‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ${score}‡¶ü‡¶ø ‡¶∏‡¶†‡¶ø‡¶ï ‡¶ï‡¶∞‡ßá‡¶õ‡ßá‡¶®`);
  }

  function showToast(msg) {
    const toast = document.getElementById("toast");
    toast.textContent = msg;
    toast.className = "toast show";
    setTimeout(() => {
      toast.className = "toast";
    }, 5000);
  }
</script>
</body>
</html>
